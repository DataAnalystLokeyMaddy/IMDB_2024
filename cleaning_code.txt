# ---> here we merge all the CSV files into a master CSV


import pandas as pd
import glob

# Get list of all genre CSV files
csv_files = glob.glob("*_Movies_2024.csv")  # matches files like Horror_Movies_2024.csv

# Read and concatenate all files
df_list = [pd.read_csv(file) for file in csv_files]
master_df = pd.concat(df_list, ignore_index=True)

# Optional: remove duplicates if same movie appears in multiple genres
master_df.drop_duplicates(subset=["MovieName"], inplace=True)

# Save as master CSV
master_df.to_csv("master_IMDB_2024.csv", index=False, encoding="utf-8-sig")

print(f"Merged {len(csv_files)} files into master_IMDB_2024.csv with {len(master_df)} movies")
